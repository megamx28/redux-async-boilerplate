language: node_js

cache:
  directories:
    - node_modules

notifications:
  email: true

node_js:
  - stable

before_script:
  - npm prune
  - npm install -g codeclimate-test-reporter

script:
  - npm run lint
  - npm run flow
  - npm run test:coverage
  - npm run build

after_success:
  - npm run semantic-release
  - CODECLIMATE_REPO_TOKEN=RL0tMX5lJl7TJYeHvw9fiKNa+4JwmYftKRqyTl+Gw19qw/iVYL/88MnJWir7Yt0c2eo6+WCj791EH7/lPG/oQT8SarAEWswStvmTcQoIkrhs7Igf5ra0zN9Vkkn0xDyFY6nIAD1nrbC9WqBCwYSg8m38seQauTahIrysz1vFfahGwDd5yZ6N20CHGX+ZDafgKQwE0VplSpABH2h9TX8hyOwIPgNi8dUd7BTK0/Rjnq2WhYlwbM7FQKTVs6txtIZR5i2woF4GbbDX5KpqCwSTw4U24iIgzZtujNpXJL0EUlHZwBj/p1veZI5Hl17++u5BUY6APu7f5pnxz2sV89AaE6d9DVUiIuM7sV1ZQmolbVPhGUX2t7sjSPptSPUmTiTZavjlJ0D3GiRyfjLUqg2WRVdEJTBcaquDvNEsQi7iB1v1J6RSIzqEwFMUh0cO8Y17ylmwsMPV9TwL2IfbOmh4SNXvcxLjIuhc2Xu1ZuwXi41u+9qtJsXnTGDTb1w/QgfO8PNkBPz5rfnsHMoZ9YbSzsWjdD0mv4GkwGPEcTb6niy5GMQtEwtsEvzqkU1VyjRGIg6x83TxqkGMLNgCPquxb2GQ9eeZRo3s3SwTuCt64JIDG9XlA1QeWgPtOvOcOV01kIxsYwXhC/5TqBh6pe2yOdQ8oF4Dgw/Z4zpWrhIgKzg= codeclimate-test-reporter < coverage/lcov.info

branches:
  except:
    - /^v\d+\.\d+\.\d+$/
